/* xos_secdrv.h COPYRIGHT FUJITSU LIMITED 2017 */

#ifndef __XOS_SC_SYS_H__
#define __XOS_SC_SYS_H__

#include <xos_sys_common.h>

/* register encode */
#define XOS_SCCR_CTRL_EL1	sys_reg(3, 0, 11, 8, 0)
#define XOS_SCCR_ASSIGN_EL1	sys_reg(3, 0, 11, 8, 1)
#define XOS_SCCR_SET0_L2_EL1	sys_reg(3, 0, 15, 8, 2)
#define XOS_SCCR_SET1_L2_EL1	sys_reg(3, 0, 15, 8, 3)
#define XOS_SCCR_L1_EL0		sys_reg(3, 3, 11, 8, 2)
#define XOS_SCCR_VSCCR_L2_EL0	sys_reg(3, 3, 15, 8, 2)

#define XOS_CSSELR_EL1		sys_reg(3, 2, 0, 0, 0)
#define XOS_CCSIDR_EL1		sys_reg(3, 1, 0, 0, 0)

/* sector mode */
#define XOS_SCDRV_NORMAL_MODE (0)
#define XOS_SCDRV_SPECIAL_MODE (1)

/* register field */
#define XOS_SCCR_CTRL_EL1_EL1AE_MASK (1UL << 63)
#define XOS_SCCR_CTRL_EL1_EL0AE_MASK (1UL << 62)

#define XOS_SCCR_ASSIGN_EL1_DEFAULT_SECTOR_MASK (3UL)
#define XOS_SCCR_ASSIGN_EL1_ASSIGN_MASK (4UL)
#define XOS_SCCR_ASSIGN_EL1_MODE_MASK (8UL)
#define XOS_SCCR_ASSIGN_EL1_DEFAULT_SECTOR_SHIFT (0)
#define XOS_SCCR_ASSIGN_EL1_ASSIGN_SHIFT (2)
#define XOS_SCCR_ASSIGN_EL1_MODE_SHIFT (3)

/* sector mask */
#define XOS_SCCR_L1_EL0_L1_SEC0_MASK (0x7UL)
#define XOS_SCCR_L1_EL0_L1_SEC1_MASK (0x70UL)
#define XOS_SCCR_L1_EL0_L1_SEC2_MASK (0x700UL)
#define XOS_SCCR_L1_EL0_L1_SEC3_MASK (0x7000UL)

#define XOS_SCCR_L1_EL0_L1_SEC0_SHIFT (0)
#define XOS_SCCR_L1_EL0_L1_SEC1_SHIFT (4)
#define XOS_SCCR_L1_EL0_L1_SEC2_SHIFT (8)
#define XOS_SCCR_L1_EL0_L1_SEC3_SHIFT (12)

#define XOS_SCCR_VSCCR_L2_EL0_L2_SEC0_MASK (0x1FUL)
#define XOS_SCCR_VSCCR_L2_EL0_L2_SEC1_MASK (0x1F00UL)

#define XOS_SCCR_VSCCR_L2_EL0_L2_SEC0_SHIFT (0)
#define XOS_SCCR_VSCCR_L2_EL0_L2_SEC1_SHIFT (8)

#define XOS_SCCR_SET0_L2_EL1_L2_SEC0_MASK (0x1FUL)
#define XOS_SCCR_SET0_L2_EL1_L2_SEC1_MASK (0x1F00UL)
#define XOS_SCCR_SET1_L2_EL1_L2_SEC0_MASK (0x1FUL)
#define XOS_SCCR_SET1_L2_EL1_L2_SEC1_MASK (0x1F00UL)

#define XOS_SCCR_SET0_L2_EL1_L2_SEC0_SHIFT (0)
#define XOS_SCCR_SET0_L2_EL1_L2_SEC1_SHIFT (8)
#define XOS_SCCR_SET1_L2_EL1_L2_SEC0_SHIFT (0)
#define XOS_SCCR_SET1_L2_EL1_L2_SEC1_SHIFT (8)

#define XOS_CSSELR_EL1_LEVEL_MASK (0xEU)
#define XOS_CSSELR_EL1_LEVEL_SHIFT (1)
#define XOS_CSSELR_EL1_IND_MASK (0x1)
#define XOS_CSSELR_EL1_IND_SHIFT (0)
#define XOS_CSSELR_EL1_L1_CACHE (0)
#define XOS_CSSELR_EL1_L2_CACHE (1)

#define XOS_CCSIDR_EL1_WT_MASK (0x1 << 31)
#define XOS_CCSIDR_EL1_WT_SHIFT (31)
#define XOS_CCSIDR_EL1_WB_MASK (0x1 << 30)
#define XOS_CCSIDR_EL1_WB_SHIFT (30)
#define XOS_CCSIDR_EL1_RA_MASK (0x1 << 29)
#define XOS_CCSIDR_EL1_RA_SHIFT (29)
#define XOS_CCSIDR_EL1_WA_MASK (0x1 << 28)
#define XOS_CCSIDR_EL1_WA_SHIFT (28)
#define XOS_CCSIDR_EL1_NUMSETS_MASK (0x0FFFE000)
#define XOS_CCSIDR_EL1_NUMSETS_SHIFT (13)
#define XOS_CCSIDR_EL1_ASSOCIATIVITY_MASK  (0x00001FF8)
#define XOS_CCSIDR_EL1_ASSOCIATIVITY_SHIFT (3)
#define XOS_CCSIDR_EL1_LINESIZE_MASK (0x00000007)
#define XOS_CCSIDR_EL1_LINESIZE_SHIFT (0)

void scdrv_registers_init(void);

#endif /* __XOS_SCLIB_SCDRV_COMMON_H__ */
